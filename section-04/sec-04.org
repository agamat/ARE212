#+INCLUDE: ../orgpreamble.org

*Goodness of Fit* \hfill
*ARE212*: Section 04 \\ \hline \bigskip

* Additional puzzles

1. *Partitioned regression*: Generate a $100 \times 4$ matrix $\X$
   /including/ a column of ones for the intercept. Additionally,
   generate a vector $\y$ according to the generating process: $$y_i =
   1 + x_{1i} + 2x_{2i} + 3x_{3i}  + \epsilon_i, $$ where
   $\epsilon_i \sim N(0,1)$.  Let $\Q$ be the first three columns of $\X$
   and let $\N$ be the final column.  In addition, let
   \begin{eqnarray*}
      \gho  &=& (\Qp\Q)^{-1}\Qp\y \and \f = \y - \Q\gho   \\
      \ght  &=& (\Qp\Q)^{-1}\Qp\N \and \g = \N - \Q\ght   \\
      \ghth &=& \f \cdot \g / ||\g||^2 \and \e = \f - \g \ghth
   \end{eqnarray*}
   Show that $\hat{\beta} = [\gho - \ght\ghth \hspace{10pt}
   \ghth]$. Note that the total dimension of $\hat{\beta}$ is 4.

*Answer:*

#+begin_src R :results output graphics :exports both :tangle yes :session
  X <- cbind(1, randomMat(100, 3))
  e <- rnorm(100)

  beta <- c(1, 1, 2, 3)
  y <- X %*% beta + e

  Q <- X[, 1:3]
  N <- X[, 4]
  gamma.1 <- solve(t(Q) %*% Q) %*% t(Q) %*% y
  gamma.2 <- solve(t(Q) %*% Q) %*% t(Q) %*% N
  f <- y - Q %*% gamma.1
  g <- N - Q %*% gamma.2
  gamma.3 <- as.numeric(crossprod(f,g)/crossprod(g,g))
  e <- f - g * gamma.3

  (b <- c(gamma.1 - gamma.2 * gamma.3, gamma.3))
#+end_src

#+results:
: [1] 0.9406504 1.0952703 2.1492073 2.8091920


